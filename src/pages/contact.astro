---

import BaseLayout from '../layouts/BaseLayout.astro';
import Container from '../components/ui/Container.astro';
import Button from '../components/ui/Button.astro';
import { siteConfig } from '../lib/site.ts';

---

<BaseLayout title="Contact - Calcery" description="Contactez-nous pour vos questions, suggestions ou probl√®mes techniques.">

  <!-- HERO -->
  <section class="bg-white border-b border-gray-200 py-20">
    <Container>
      <div class="text-center max-w-4xl mx-auto">
        <h1 class="text-5xl md:text-6xl font-bold text-black mb-6 leading-tight">Nous contacter</h1>
        <p class="text-xl text-gray-600 font-light">Vous avez une question ? Un bug ? Une id√©e ? Nous adorons vos retours.</p>
      </div>
    </Container>
  </section>

  <Container class="py-20">
    <div class="max-w-3xl mx-auto">

      <!-- CONTACT FORM -->
      <section class="mb-16">
        <form method="post" class="space-y-6" id="contact-form">
          <div>
            <label for="name" class="block text-sm font-semibold text-gray-900 mb-3">Nom complet *</label>
            <input type="text" id="name" name="name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white">
          </div>

          <div>
            <label for="email" class="block text-sm font-semibold text-gray-900 mb-3">Adresse email *</label>
            <input type="email" id="email" name="email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white">
          </div>

          <div>
            <label for="subject" class="block text-sm font-semibold text-gray-900 mb-3">Sujet du message *</label>
            <select id="subject" name="subject" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white">
              <option value="">S√©lectionnez un sujet</option>
              <option value="question">Question g√©n√©rale</option>
              <option value="bug">Signalement d'un bug</option>
              <option value="suggestion">Suggestion d'am√©lioration</option>
              <option value="partnership">Partenariat</option>
              <option value="other">Autre</option>
            </select>
          </div>

          <div>
            <label for="message" class="block text-sm font-semibold text-gray-900 mb-3">Votre message *</label>
            <textarea id="message" name="message" rows="7" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white resize-none" placeholder="D√©crivez votre question, votre bug ou votre suggestion..."></textarea>
          </div>

          <!-- Honeypot field -->
          <div style="display: none;">
            <label for="website">Website</label>
            <input type="text" id="website" name="website">
          </div>

          <Button type="submit" class="w-full">Envoyer le message</Button>

          <p class="text-sm text-gray-600 text-center">
            En soumettant ce formulaire, votre client email s'ouvrira pour envoyer votre message √† <a href={`mailto:${siteConfig.siteEmail}`} class="text-black hover:underline font-medium">{siteConfig.siteEmail}</a>.
          </p>
        </form>
      </section>

      <!-- INFO CARDS -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
        <div class="bg-gray-50 border border-gray-200 rounded-xl p-8">
          <h2 class="text-2xl font-bold text-black mb-4">üìß Par email</h2>
          <p class="text-gray-700 mb-4">La fa√ßon la plus simple de nous contacter. R√©ponse sous 24-48 heures ouvr√©es.</p>
          <a href={`mailto:${siteConfig.siteEmail}`} class="text-black hover:underline font-semibold">
            {siteConfig.siteEmail}
          </a>
        </div>

        <div class="bg-gray-50 border border-gray-200 rounded-xl p-8">
          <h2 class="text-2xl font-bold text-black mb-4">üìç Notre adresse</h2>
          <p class="text-gray-700">
            <strong>Maison Ellis</strong><br>
            {siteConfig.editorAddress}
          </p>
        </div>
      </div>

      <!-- SUPPORT SECTION -->
      <section class="bg-white border border-gray-200 rounded-xl p-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-6">Vous avez besoin d'aide ?</h2>
        <div class="space-y-4 text-gray-700 leading-relaxed">
          <div>
            <h3 class="font-semibold text-gray-900 mb-2">üêõ Vous avez trouv√© un bug ?</h3>
            <p>D√©crivez-le avec le plus de d√©tails possible (navigateur, device, √©tapes pour reproduire). Cela nous aide √©norm√©ment!</p>
          </div>
          <div>
            <h3 class="font-semibold text-gray-900 mb-2">üí° Vous avez une id√©e d'am√©lioration ?</h3>
            <p>Nous adorons √©couter vos suggestions ! Envoyez-nous votre retour pour nous aider √† am√©liorer Calcery.</p>
          </div>
          <div>
            <h3 class="font-semibold text-gray-900 mb-2">ü§ù Int√©ress√© par un partenariat ?</h3>
            <p>Nous sommes ouverts aux collaborations. Discutons-en par email !</p>
          </div>
        </div>
      </section>

    </div>
  </Container>

</BaseLayout>

<script define:vars={{ email: siteConfig.siteEmail }}>
  const form = document.getElementById('contact-form');
  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const name = document.getElementById('name').value;
      const emailVal = document.getElementById('email').value;
      const subject = document.getElementById('subject').value;
      const message = document.getElementById('message').value;
      const website = document.getElementById('website').value;
      
      // Honeypot check
      if (website) {
        console.log('Honeypot triggered');
        return;
      }
      
      const subjectMap = {
        question: 'Question g√©n√©rale',
        bug: 'Signalement d\'un bug',
        suggestion: 'Suggestion d\'am√©lioration',
        partnership: 'Partenariat',
        other: 'Autre',
      };
      
      const emailSubject = `Contact Calcery - ${subjectMap[subject] || subject}`;
      const emailBody = `Nom: ${name}\nEmail: ${emailVal}\nSujet: ${subjectMap[subject] || subject}\n\nMessage:\n${message}`;
      
      const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
      window.location.href = mailtoLink;
    });
  }
</script>