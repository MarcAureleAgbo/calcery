---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Container from '../../components/ui/Container.astro';
import Button from '../../components/ui/Button.astro';
import { siteConfig } from '../../lib/site.ts';
---

<BaseLayout title="Contact - Calcery" description="Contact us for questions, feedback or technical issues." lang="en">
  <section class="border-b border-gray-200 bg-white py-20">
    <Container>
      <div class="mx-auto max-w-4xl text-center">
        <h1 class="mb-6 text-5xl font-bold leading-tight text-black md:text-6xl">Contact us</h1>
        <p class="text-xl font-light text-gray-600">Questions, bug reports, or ideas are always welcome.</p>
      </div>
    </Container>
  </section>

  <Container class="py-20">
    <div class="mx-auto max-w-3xl">
      <section class="mb-16">
        <form method="post" class="space-y-6" id="contact-form-en">
          <div>
            <label for="name" class="mb-3 block text-sm font-semibold text-gray-900">Full name *</label>
            <input type="text" id="name" name="name" required class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primary" />
          </div>

          <div>
            <label for="email" class="mb-3 block text-sm font-semibold text-gray-900">Email address *</label>
            <input type="email" id="email" name="email" required class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primary" />
          </div>

          <div>
            <label for="subject" class="mb-3 block text-sm font-semibold text-gray-900">Subject *</label>
            <select id="subject" name="subject" required class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primary">
              <option value="">Select a subject</option>
              <option value="question">General question</option>
              <option value="bug">Bug report</option>
              <option value="suggestion">Improvement suggestion</option>
              <option value="partnership">Partnership</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div>
            <label for="message" class="mb-3 block text-sm font-semibold text-gray-900">Message *</label>
            <textarea id="message" name="message" rows="7" required class="w-full resize-none rounded-lg border border-gray-300 bg-white px-4 py-3 transition-all focus:border-transparent focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Describe your request, bug report, or idea..."></textarea>
          </div>

          <div class="hidden" aria-hidden="true">
            <label for="website">Website</label>
            <input type="text" id="website" name="website" />
          </div>

          <Button type="submit" class="w-full">Send message</Button>

          <p class="text-center text-sm text-gray-600">
            Submitting this form opens your email client and prepares a message to
            <a href={`mailto:${siteConfig.siteEmail}`} class="font-medium text-black hover:underline">{siteConfig.siteEmail}</a>.
          </p>
        </form>
      </section>

      <div class="mb-16 grid grid-cols-1 gap-8 md:grid-cols-2">
        <div class="rounded-xl border border-gray-200 bg-gray-50 p-8">
          <h2 class="mb-4 text-2xl font-bold text-black">Email</h2>
          <p class="mb-4 text-gray-700">Fastest way to reach us. Typical response time: 24-48 business hours.</p>
          <a href={`mailto:${siteConfig.siteEmail}`} class="font-semibold text-black hover:underline">{siteConfig.siteEmail}</a>
        </div>

        <div class="rounded-xl border border-gray-200 bg-gray-50 p-8">
          <h2 class="mb-4 text-2xl font-bold text-black">Address</h2>
          <p class="text-gray-700">
            <strong>Maison Ellis</strong><br />
            {siteConfig.editorAddress}
          </p>
        </div>
      </div>

      <section class="rounded-xl border border-gray-200 bg-white p-8">
        <h2 class="mb-6 text-3xl font-bold text-gray-900">Need help?</h2>
        <div class="space-y-4 leading-relaxed text-gray-700">
          <div>
            <h3 class="mb-2 font-semibold text-gray-900">Found a bug?</h3>
            <p>Include browser, device and exact steps to reproduce the issue.</p>
          </div>
          <div>
            <h3 class="mb-2 font-semibold text-gray-900">Have an idea?</h3>
            <p>Send your suggestions. Product feedback helps us improve the platform.</p>
          </div>
          <div>
            <h3 class="mb-2 font-semibold text-gray-900">Partnership inquiry?</h3>
            <p>Contact us by email and we will get back to you quickly.</p>
          </div>
        </div>
      </section>
    </div>
  </Container>
</BaseLayout>

<script define:vars={{ email: siteConfig.siteEmail }}>
  const form = document.getElementById('contact-form-en');

  if (form) {
    form.addEventListener('submit', (event) => {
      event.preventDefault();

      const name = document.getElementById('name').value;
      const emailVal = document.getElementById('email').value;
      const subject = document.getElementById('subject').value;
      const message = document.getElementById('message').value;
      const website = document.getElementById('website').value;

      if (website) return;

      const subjectMap = {
        question: 'General question',
        bug: 'Bug report',
        suggestion: 'Improvement suggestion',
        partnership: 'Partnership',
        other: 'Other',
      };

      const finalSubject = subjectMap[subject] || subject;
      const emailSubject = `Calcery contact - ${finalSubject}`;
      const emailBody = `Name: ${name}\nEmail: ${emailVal}\nSubject: ${finalSubject}\n\nMessage:\n${message}`;

      const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
      window.location.href = mailtoLink;
    });
  }
</script>
